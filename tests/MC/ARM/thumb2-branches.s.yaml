test_cases:
  -
    input:
      bytes: [ 0x00, 0xe4 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b #-0x800"
  -
    input:
      bytes: [ 0xff, 0xe3 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b #0x7fe"
  -
    input:
      bytes: [ 0xff, 0xf7, 0x00, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #-0x800"
  -
    input:
      bytes: [ 0x00, 0xf0, 0xff, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #0x7fe"
  -
    input:
      bytes: [ 0x66, 0xf6, 0x30, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #-0x1997a0"
  -
    input:
      bytes: [ 0x99, 0xf1, 0xcf, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #0x19979e"
  -
    input:
      bytes: [ 0x00, 0xe4 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b #-0x800"
  -
    input:
      bytes: [ 0xff, 0xe3 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b #0x7fe"
  -
    input:
      bytes: [ 0xff, 0xf7, 0xff, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #-0x802"
  -
    input:
      bytes: [ 0x00, 0xf0, 0x00, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #0x800"
  -
    input:
      bytes: [ 0x66, 0xf6, 0x30, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #-0x1997a0"
  -
    input:
      bytes: [ 0x99, 0xf1, 0xcf, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #0x19979e"
  -
    input:
      bytes: [ 0x08, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it eq"
  -
    input:
      bytes: [ 0x00, 0xe4 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "beq #-0x800"
  -
    input:
      bytes: [ 0x18, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it ne"
  -
    input:
      bytes: [ 0x01, 0xe4 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #-0x7fe"
  -
    input:
      bytes: [ 0xc8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it gt"
  -
    input:
      bytes: [ 0xff, 0xf7, 0x00, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bgt.w #-0x800"
  -
    input:
      bytes: [ 0xd8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it le"
  -
    input:
      bytes: [ 0x00, 0xf0, 0xff, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ble.w #0x7fe"
  -
    input:
      bytes: [ 0xa8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it ge"
  -
    input:
      bytes: [ 0x66, 0xf6, 0x30, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bge.w #-0x1997a0"
  -
    input:
      bytes: [ 0xb8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it lt"
  -
    input:
      bytes: [ 0x99, 0xf1, 0xcf, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "blt.w #0x19979e"
  -
    input:
      bytes: [ 0x80, 0xd0 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "beq #-0x100"
  -
    input:
      bytes: [ 0x7f, 0xd1 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #0xfe"
  -
    input:
      bytes: [ 0x00, 0xf0, 0x80, 0xf8 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bl #0x100"
  -
    input:
      bytes: [ 0x18, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it ne"
  -
    input:
      bytes: [ 0x00, 0xf0, 0x80, 0xf8 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "blne #0x100"
  -
    input:
      bytes: [ 0x3f, 0xf5, 0x80, 0xaf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bmi.w #-0x100"
  -
    input:
      bytes: [ 0x40, 0xf0, 0x7f, 0x80 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne.w #0xfe"
  -
    input:
      bytes: [ 0xc0, 0xf6, 0x00, 0x80 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "blt.w #-0x100000"
  -
    input:
      bytes: [ 0xbf, 0xf2, 0xff, 0xaf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bge.w #0xffffe"
  -
    input:
      bytes: [ 0x80, 0xd1 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #-0x100"
  -
    input:
      bytes: [ 0x7f, 0xdc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bgt #0xfe"
  -
    input:
      bytes: [ 0x7f, 0xf4, 0x7f, 0xaf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne.w #-0x102"
  -
    input:
      bytes: [ 0x00, 0xf3, 0x80, 0x80 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bgt.w #0x100"
  -
    input:
      bytes: [ 0x40, 0xf4, 0x00, 0x80 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne.w #-0x100000"
  -
    input:
      bytes: [ 0x3f, 0xf3, 0xff, 0xaf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bgt.w #0xffffe"
  -
    input:
      bytes: [ 0x08, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it eq"
  -
    input:
      bytes: [ 0x08, 0x44 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "addeq r0, r1"
  -
    input:
      bytes: [ 0x40, 0xd1 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #0x80"
  -
    input:
      bytes: [ 0x0c, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ite eq"
  -
    input:
      bytes: [ 0x08, 0x44 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "addeq r0, r1"
  -
    input:
      bytes: [ 0x40, 0xe0 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #0x80"
  -
    input:
      bytes: [ 0x00, 0xe4 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b #-0x800"
  -
    input:
      bytes: [ 0xff, 0xe3 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b #0x7fe"
  -
    input:
      bytes: [ 0xff, 0xf7, 0x00, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #-0x800"
  -
    input:
      bytes: [ 0x00, 0xf0, 0xff, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #0x7fe"
  -
    input:
      bytes: [ 0x66, 0xf6, 0x30, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #-0x1997a0"
  -
    input:
      bytes: [ 0x99, 0xf1, 0xcf, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #0x19979e"
  -
    input:
      bytes: [ 0x00, 0xe4 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b #-0x800"
  -
    input:
      bytes: [ 0xff, 0xe3 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b #0x7fe"
  -
    input:
      bytes: [ 0xff, 0xf7, 0xff, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #-0x802"
  -
    input:
      bytes: [ 0x00, 0xf0, 0x00, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #0x800"
  -
    input:
      bytes: [ 0x66, 0xf6, 0x30, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #-0x1997a0"
  -
    input:
      bytes: [ 0x99, 0xf1, 0xcf, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b.w #0x19979e"
  -
    input:
      bytes: [ 0x08, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it eq"
  -
    input:
      bytes: [ 0x00, 0xe4 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "beq #-0x800"
  -
    input:
      bytes: [ 0x18, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it ne"
  -
    input:
      bytes: [ 0x01, 0xe4 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #-0x7fe"
  -
    input:
      bytes: [ 0xc8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it gt"
  -
    input:
      bytes: [ 0xff, 0xf7, 0x00, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bgt.w #-0x800"
  -
    input:
      bytes: [ 0xd8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it le"
  -
    input:
      bytes: [ 0x00, 0xf0, 0xff, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ble.w #0x7fe"
  -
    input:
      bytes: [ 0xa8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it ge"
  -
    input:
      bytes: [ 0x66, 0xf6, 0x30, 0xbc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bge.w #-0x1997a0"
  -
    input:
      bytes: [ 0xb8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it lt"
  -
    input:
      bytes: [ 0x99, 0xf1, 0xcf, 0xbb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "blt.w #0x19979e"
  -
    input:
      bytes: [ 0x80, 0xd0 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "beq #-0x100"
  -
    input:
      bytes: [ 0x7f, 0xd1 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #0xfe"
  -
    input:
      bytes: [ 0x3f, 0xf5, 0x80, 0xaf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bmi.w #-0x100"
  -
    input:
      bytes: [ 0x40, 0xf0, 0x7f, 0x80 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne.w #0xfe"
  -
    input:
      bytes: [ 0xc0, 0xf6, 0x00, 0x80 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "blt.w #-0x100000"
  -
    input:
      bytes: [ 0xbf, 0xf2, 0xff, 0xaf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bge.w #0xffffe"
  -
    input:
      bytes: [ 0x80, 0xd1 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #-0x100"
  -
    input:
      bytes: [ 0x7f, 0xdc ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bgt #0xfe"
  -
    input:
      bytes: [ 0x7f, 0xf4, 0x7f, 0xaf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne.w #-0x102"
  -
    input:
      bytes: [ 0x00, 0xf3, 0x80, 0x80 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bgt.w #0x100"
  -
    input:
      bytes: [ 0x40, 0xf4, 0x00, 0x80 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne.w #-0x100000"
  -
    input:
      bytes: [ 0x3f, 0xf3, 0xff, 0xaf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bgt.w #0xffffe"
  -
    input:
      bytes: [ 0x08, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it eq"
  -
    input:
      bytes: [ 0x08, 0x44 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "addeq r0, r1"
  -
    input:
      bytes: [ 0x40, 0xd1 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #0x80"
  -
    input:
      bytes: [ 0x0c, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ite eq"
  -
    input:
      bytes: [ 0x08, 0x44 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "addeq r0, r1"
  -
    input:
      bytes: [ 0x40, 0xe0 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bne #0x80"
  -
    input:
      bytes: [ 0x01, 0xe0 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "b #2"
  -
    input:
      bytes: [ 0x00, 0xf0, 0x01, 0xf8 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "bl #2"
  -
    input:
      bytes: [ 0x01, 0xd0 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "beq #2"
  -
    input:
      bytes: [ 0x08, 0xb1 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "cbz r0, #2"
  -
    input:
      bytes: [ 0x00, 0xf0, 0x02, 0xe8 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "blx #4"

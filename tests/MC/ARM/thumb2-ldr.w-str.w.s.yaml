test_cases:
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0x3b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r3, [r1], #4"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0x3b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r3, [r1], #4"
  -
    input:
      bytes: [ 0x40, 0xf8, 0x04, 0x3b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r3, [r0], #4"
  -
    input:
      bytes: [ 0x40, 0xf8, 0x04, 0x3b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r3, [r0], #4"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0x3d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r3, [r1, #-4]!"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0x3d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r3, [r1, #-4]!"
  -
    input:
      bytes: [ 0x40, 0xf8, 0x04, 0x3d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r3, [r0, #-4]!"
  -
    input:
      bytes: [ 0x40, 0xf8, 0x04, 0x3d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r3, [r0, #-4]!"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0x0d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r0, [r1, #-4]!"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0xdd ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr sp, [r1, #-4]!"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0xfd ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr pc, [r1, #-4]!"
  -
    input:
      bytes: [ 0x50, 0xf8, 0x04, 0x1d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r1, [r0, #-4]!"
  -
    input:
      bytes: [ 0x5d, 0xf8, 0x04, 0x1d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r1, [sp, #-4]!"
  -
    input:
      bytes: [ 0x50, 0xf8, 0xff, 0x1f ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r1, [r0, #0xff]!"
  -
    input:
      bytes: [ 0x50, 0xf8, 0xff, 0x1d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r1, [r0, #-0xff]!"
  -
    input:
      bytes: [ 0x50, 0xf8, 0x00, 0x1f ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r1, [r0, #0]!"
  -
    input:
      bytes: [ 0x08, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it eq"
  -
    input:
      bytes: [ 0x50, 0xf8, 0xff, 0x1f ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldreq r1, [r0, #0xff]!"
  -
    input:
      bytes: [ 0xd8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it le"
  -
    input:
      bytes: [ 0x50, 0xf8, 0xff, 0x1f ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldrle r1, [r0, #0xff]!"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r0, [r1], #4"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0xdb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr sp, [r1], #4"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0xfb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr pc, [r1], #4"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x04, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r0, [r1], #4"
  -
    input:
      bytes: [ 0x5d, 0xf8, 0x04, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "pop {r0}"
  -
    input:
      bytes: [ 0x5f, 0xf8, 0x04, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr.w r0, [pc, #-0xb04]"
  -
    input:
      bytes: [ 0x51, 0xf8, 0xff, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r0, [r1], #0xff"
  -
    input:
      bytes: [ 0x51, 0xf8, 0x00, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r0, [r1], #0"
  -
    input:
      bytes: [ 0x51, 0xf8, 0xff, 0x09 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldr r0, [r1], #-0xff"
  -
    input:
      bytes: [ 0x08, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it eq"
  -
    input:
      bytes: [ 0x51, 0xf8, 0xff, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldreq r0, [r1], #0xff"
  -
    input:
      bytes: [ 0xd8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it le"
  -
    input:
      bytes: [ 0x51, 0xf8, 0xff, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "ldrle r0, [r1], #0xff"
  -
    input:
      bytes: [ 0x40, 0xf8, 0x04, 0x1d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [r0, #-4]!"
  -
    input:
      bytes: [ 0x40, 0xf8, 0x04, 0xdd ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str sp, [r0, #-4]!"
  -
    input:
      bytes: [ 0x42, 0xf8, 0x04, 0x1d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [r2, #-4]!"
  -
    input:
      bytes: [ 0x4d, 0xf8, 0x04, 0x1d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [sp, #-4]!"
  -
    input:
      bytes: [ 0x42, 0xf8, 0xff, 0x1f ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [r2, #0xff]!"
  -
    input:
      bytes: [ 0x42, 0xf8, 0x00, 0x1f ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [r2, #0]!"
  -
    input:
      bytes: [ 0x42, 0xf8, 0xff, 0x1d ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [r2, #-0xff]!"
  -
    input:
      bytes: [ 0x08, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it eq"
  -
    input:
      bytes: [ 0x42, 0xf8, 0xff, 0x1f ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "streq r1, [r2, #0xff]!"
  -
    input:
      bytes: [ 0xd8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it le"
  -
    input:
      bytes: [ 0x42, 0xf8, 0xff, 0x1f ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "strle r1, [r2, #0xff]!"
  -
    input:
      bytes: [ 0x40, 0xf8, 0x04, 0x1b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [r0], #4"
  -
    input:
      bytes: [ 0x40, 0xf8, 0x04, 0xdb ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str sp, [r0], #4"
  -
    input:
      bytes: [ 0x41, 0xf8, 0x04, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r0, [r1], #4"
  -
    input:
      bytes: [ 0x4d, 0xf8, 0x04, 0x0b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r0, [sp], #4"
  -
    input:
      bytes: [ 0x40, 0xf8, 0xff, 0x1b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [r0], #0xff"
  -
    input:
      bytes: [ 0x40, 0xf8, 0x00, 0x1b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [r0], #0"
  -
    input:
      bytes: [ 0x40, 0xf8, 0xff, 0x19 ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "str r1, [r0], #-0xff"
  -
    input:
      bytes: [ 0x08, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it eq"
  -
    input:
      bytes: [ 0x40, 0xf8, 0xff, 0x1b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "streq r1, [r0], #0xff"
  -
    input:
      bytes: [ 0xd8, 0xbf ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "it le"
  -
    input:
      bytes: [ 0x40, 0xf8, 0xff, 0x1b ]
      arch: "CS_ARCH_ARM"
      options: [ "CS_MODE_THUMB" ]
    expected:
      insns:
        -
          asm_text: "strle r1, [r0], #0xff"
